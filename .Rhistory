library("xts")
# install.packages("dplyr")
library('dplyr') # data manipulation
# library('readr') # input/output
# library('data.table') # data manipulation
# install.packages('tibble')
library('tibble') # data wrangling
# library('tidyr') # data wrangling
# library('stringr') # string manipulation
# library('forcats') # factor manipulation
# install.packages('tidytext')
library('tidytext')
# install.packages("magrittr")
library('magrittr')
# install.packages("tidyr")
library("tidyr")
# install.packages("ggplot2")
library("ggplot2")
# install.packages("plotly")
library("plotly")
# install.packages("pamr")
library("pamr")
# We want to treat each column as characters, not factors, except for the author column.
spooky <- read.csv('../data/spooky.csv', colClasses = 'character')
spooky <- as.tibble(spooky)
spooky$author <- as.factor(spooky$author)
summary(spooky)
all_po <- data.frame(
count(data_counts, word1)
)
pronouns <- c("he","she")
data <- spooky %>%
unnest_tokens(word, text, token = "ngrams", n = 2, to_lower = TRUE, drop = TRUE)
data <- spooky %>%
unnest_tokens(word, text, token = "ngrams", n = 2, to_lower = TRUE, drop = TRUE)
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
count(word1, word2, wt = n, sort = TRUE) %>%
rename(counts = "nn")
all_po <- data.frame(
count(data_counts, word1)
)
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
count(word1, word2, wt = n, sort = TRUE) %>%
rename(counts = "nn")
all_po <- data.frame(
count(data_counts, word1)
)
po1 <- ggplot(temp, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
all_po <- data.frame(
count(data_counts, word1)
)
po1 <- ggplot(all_po, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
dev.off()
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
dev.off()
data_counts_by_author <- data %>%
count(author, word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
rename(counts = "n")
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
HPL_po <- data_counts_by_author %>%
filter(author == "HPL") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
EAP_po <- data_counts_by_author %>%
filter(author == "EAP") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
p1 <- ggplot(MWS_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
p2 <- ggplot(HPL_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
p3 <- ggplot(EAP_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
layout <- matrix(c(1,2,3), 1, 3, byrow = TRUE)
multiplot(p1, p2, p3, layout = layout)
source("../libs/multiplot.R")
source("../libs/multiplot.R")
getwd()
source("/libs/multiplot.R")
source("../libs/multiplot.R")
source("../libs/multiplot.R")
getwd()
getwd()
getwd()
source("../libs/multiplot.R")
View(all_po)
rename(all_po, counts = "n"", pronouns = "word1")
?rename
rename(all_po, counts = "n", pronouns = "word1")
View(all_po)
rename(all_po, counts = "n", pronouns = "word1")
View(all_po)
rename(all_po, c("n" = "counts","word1" to "pronouns"))
rename(all_po, c("n" = "counts","word1" = "pronouns"))
View(all_po)
all_po <- all_po %>%
rename(counts = "n",
pronouns = "word1")
View(all_po)
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=n, fill=pronouns))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
ggplot(all_po, aes(x="", y=n, fill=pronouns))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
ggplot(all_po, aes(x="", y=counts, fill=pronouns))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=counts, fill=pronouns))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
dev.off()
library("xts")
# install.packages("dplyr")
library('dplyr') # data manipulation
# library('readr') # input/output
# library('data.table') # data manipulation
# install.packages('tibble')
library('tibble') # data wrangling
# library('tidyr') # data wrangling
# library('stringr') # string manipulation
# library('forcats') # factor manipulation
# install.packages('tidytext')
library('tidytext')
# install.packages("magrittr")
library('magrittr')
# install.packages("tidyr")
library("tidyr")
# install.packages("ggplot2")
library("ggplot2")
# install.packages("plotly")
library("plotly")
# install.packages("pamr")
library("pamr")
source("../libs/multiplot.R")
source("../lib/multiplot.R")
layout <- matrix(c(1,2,3), 1, 3, byrow = TRUE)
multiplot(p1, p2, p3, layout = layout)
?multiplot
??multiplot
?ggtitle
p1 <- ggplot(MWS_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0) +
ggtitle("MWS pronoun occurence")
p2 <- ggplot(HPL_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0) +
ggtitle("HPL pronoun occurence")
p3 <- ggplot(EAP_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0) +
ggtitle("EAP pronoun occurence")
layout <- matrix(c(1,2,3), 1, 3, byrow = TRUE)
multiplot(p1, p2, p3, layout = layout)
layout <- matrix(c(1,2,3), 1, 3, byrow = TRUE)
png("../figs/po2.png")
multiplot(p1, p2, p3, layout = layout)
dev.off()
layout <- matrix(c(1,2,3), 3,1, byrow = TRUE)
png("../figs/po2.png")
multiplot(p1, p2, p3, layout = layout)
dev.off()
png("../figs/po1.png")
ggplot(all_po, aes(x="", y=counts, fill=pronouns))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0) +
ggtitle("pronoun occurence in total")
dev.off()
View(HPL_po)
View(MWS_po)
View(HPL_po)
