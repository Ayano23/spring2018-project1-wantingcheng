is.numeric(temp_male[,1137])
View(temp_male)
?summarise_all
View(temp_male)
summarise_all(temp_male)
temp_male %>%
group_by(author) %>%
summarise_all(mean)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male") %>%
group_by(author) %>%
summarise_all(sum)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male") %>%
group_by(author) %>%
summarise_all(mean)
temp_male[,2:1137]
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male") %>%
group_by(author) %>%
summarise_all(sum)
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male")
View(temp_male)
temp_male[,3:1137] <- as.numeric(temp_male[,3:1137])
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male")
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male") %>%
group_by(author) %>%
summarise_if(is.numeric,sum)
View(temp_male)
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male")
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
rename(gender = "she") %>%
mutate(gender = "male") %>%
group_by(author) %>%
summarise_if(is.numeric,sum)
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
mutate(gender = "male")
View(temp_male)
View(temp_male)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "she") %>%
mutate(gender = "male")
View(temp_male)
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "he") %>%
mutate(gender = "female")
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup()
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
group_by(author)
View(temp_female)
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
select(-he)
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
select(-"he")
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
select(-one_of("he"))
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
count(word1, word2, wt = n, sort = TRUE) %>%
rename(counts = "nn")
# First use tidytext function to drop the punctuations and tokenize our file.
pronouns <- c("he","she")
data <- spooky %>%
unnest_tokens(word, text, token = "ngrams", n = 2, to_lower = TRUE, drop = TRUE)
# Then we get rid of the stop words ("words that are not useful for an analysis, typically extremely common words such as “the”, “of”, “to”, and so forth in English.")
# tidytext has a dictionary for stop words.
# data(stop_words)
# data <- data %>%
#   anti_join(stop_words, by = "word")
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
count(word1, word2, wt = n, sort = TRUE) %>%
rename(counts = "nn")
temp <- data.frame(
count(data_counts, word1)
)
ggplot(temp, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
data_counts_by_author <- data %>%
count(author, word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
rename(counts = "n")
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "nn")
View(data_counts_by_author)
View(data_counts)
word_ratios <- data_counts %>%
group_by(word2) %>%
filter(sum(counts) > 10) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. + 1) / sum(. + 1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio))
word_ratios %>%
arrange(abs(logratio))
word_ratios %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15, abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio)) %>%
ggplot(aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x = word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he'",
title = "Words paired with 'he' and 'she'",
subtitle = "Women throw, sleep, and turn while men####") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
EAP_word_ratios <- data_counts_by_author %>%
filter(author == "EAP") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(EAP_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in EAP's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
HPL_word_ratios <- data_counts_by_author %>%
filter(author == "HPL") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(HPL_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in HPL's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
MWS_word_ratios <- data_counts_by_author %>%
filter(author == "MWS") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(MWS_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in MWS's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
View(data_counts)
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 == "he")
View(data_counts)
View(data_counts)
data_counts_by_author <- data %>%
count(author, word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 == "he") %>%
rename(counts = "n")
data_counts_by_author <- data %>%
count(author, word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 == "he") %>%
rename(counts = "n")
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "nn")
View(MWS_po)
data_counts <- data %>%
count(word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
count(word1, word2, wt = n, sort = TRUE) %>%
rename(counts = "nn")
temp <- data.frame(
count(data_counts, word1)
)
ggplot(temp, aes(x="", y=n, fill=word1))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
data_counts_by_author <- data %>%
count(author, word, sort = TRUE) %>%
separate(word, c("word1","word2"), sep = " ", remove = TRUE) %>%
filter(word1 %in% pronouns) %>%
filter(word2 != "he") %>%
rename(counts = "n")
View(data_counts_by_author)
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "nn")
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1)
View(MWS_po)
View(MWS_po)
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1)
rename(pronoun = "word1", counts = "n")
MWS_po <- data_counts_by_author %>%
filter(author == "MWS") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
HPL_po <- data_counts_by_author %>%
filter(author == "HPL") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
EAP_po <- data_counts_by_author %>%
filter(author == "EAP") %>%
count(word1) %>%
rename(pronoun = "word1", counts = "n")
p1 <- ggplot(MWS_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
p2 <- ggplot(HPL_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
p3 <- ggplot(EAP_po, aes(x="", y=counts, fill=pronoun))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y", start = 0)
word_ratios <- data_counts %>%
group_by(word2) %>%
filter(sum(counts) > 10) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. + 1) / sum(. + 1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio))
# Equally likely:
word_ratios %>%
arrange(abs(logratio))
# Large difference:
word_ratios %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15, abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio)) %>%
ggplot(aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x = word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he'",
title = "Words paired with 'he' and 'she'",
subtitle = "Women throw, sleep, and turn while men####") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
# Separately:
# EAP
EAP_word_ratios <- data_counts_by_author %>%
filter(author == "EAP") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(EAP_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in EAP's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
# HPL
HPL_word_ratios <- data_counts_by_author %>%
filter(author == "HPL") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(HPL_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in HPL's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
# MWS
MWS_word_ratios <- data_counts_by_author %>%
filter(author == "MWS") %>%
group_by(word2) %>%
filter(sum(counts) > 5) %>%
ungroup() %>%
spread(word1, counts, fill = 0) %>%
mutate_if(is.numeric, funs((. +1)/ sum(. +1))) %>%
mutate(logratio = log2(she / he)) %>%
arrange(desc(logratio)) %>%
mutate(abslogratio = abs(logratio)) %>%
group_by(logratio < 0) %>%
top_n(15,abslogratio) %>%
ungroup() %>%
mutate(word = reorder(word2, logratio))
ggplot(MWS_word_ratios, aes(word, logratio, color = logratio < 0)) +
geom_segment(aes(x=word, xend = word,
y = 0, yend = logratio),
size = 1.1, alpha = 0.6) +
geom_point(size = 3.5) +
coord_flip() +
labs(x = NULL,
y = "Relative appearance after 'she' compared to 'he' in MWS's novels",
title = "Words paired with 'he' and 'she'") +
scale_color_discrete(name = "", labels = c("More 'she'", "More 'he'")) +
scale_y_continuous(breaks = seq(-3, 3),
labels = c("0.125x", "0.25x", "0.5x",
"Same", "2x", "4x", "8x"))
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
select(-one_of("he"))
gender.data <- data_counts_by_author %>%
spread(word1, counts, fill = 0)
temp_male <- gender.data %>%
spread(word2, he, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "she") %>%
mutate(gender = "male")
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
group_by(author)
temp_female <- gender.data %>%
spread(word2, she, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "he") %>%
mutate(gender = "female")
View(temp_female)
gender.data <- cbind(temp_male, temp_female)
View(gender.data)
gender.data <- rbind(temp_male, temp_female)
View(gender.data)
?write.csv
write.csv(gender.data, "pam.csv")
write.csv(gender.data, "../data/pam.csv")
?pamr.from.excel
View(gender.data)
khan.data <- pamr.from.excel("../data/pam.csv",1134, sample.labels = TRUE)
khan.data <- pamr.from.excel("../data/pam.csv",1135, sample.labels = TRUE)
khan.data <- pamr.from.excel("../data/pam.csv",1136, sample.labels = TRUE)
gender <- data_counts_by_author %>%
spread(word1, counts, fill = 0)
temp_male <- gender %>%
spread(word2, he, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "she") %>%
mutate(gender = "male")
temp_female <- gender %>%
spread(word2, she, fill = 0) %>%
group_by(author) %>%
summarise_if(is.numeric,sum) %>%
ungroup() %>%
rename(gender = "he") %>%
mutate(gender = "female")
gender <- rbind(temp_male, temp_female)
write.csv(gender, "../data/pam.csv")
gender.data <- pamr.from.excel("../data/pam.csv",1136, sample.labels = TRUE)
gender.data <- pamr.from.excel("../data/pam.csv", ncols = 1136, sample.labels = TRUE)
write.table(gender, "../data/pam.txt", sep = "\t")
gender.data <- pamr.from.excel("../data/pam.txt", ncols = 1136, sample.labels = TRUE)
View(gender)
gender.data <- pamr.from.excel("../data/pam.txt", ncols = 1136, sample.labels = TRUE)
pamr.to.excel(khan.data, "../data/pam.csv")
?pamr.to.excel
temp <- read.table("../data/khan.txt", sep = "\t")
View(temp)
View(gender)
?pamr.from.excel
